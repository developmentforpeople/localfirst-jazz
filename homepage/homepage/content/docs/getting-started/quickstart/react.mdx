export const metadata = {
  description: "Get started building a simple React app with Jazz."
};

import { CodeGroup } from "@/components/forMdx";
import { Alert } from "@garden-co/design-system/src/components/atoms/Alert";
import { TextLink } from "@garden-co/design-system/src/components/atoms/TextLink";

# Get started with React in 10 minutes
This quickstart guide will take you from an empty project to a working app with authentication and a simple data model.

<Alert variant="info" className="mt-4 flex gap-2 items-center">
  Requires Node.js 20+ and React 18+.
</Alert>

## Create your React App
We'll be using Next.js and TypeScript with `pnpm` for this guide, but Jazz works great with vanilla React too.

You can accept the defaults for all the questions, or customise the project as you like.

<CodeGroup>
```sh
pnpx create-next-app@latest --typescript jazzfest
cd jazzfest
```
</CodeGroup>


## Install Jazz

The `jazz-tools` package includes everything you're going to need to build your first Jazz app.

<CodeGroup>
```sh
pnpm add jazz-tools
```
</CodeGroup>

## Get your free API key

Sign up for a free API key at [dashboard.jazz.tools](https://dashboard.jazz.tools) for higher limits or production use, or use your email address as a temporary key to get started quickly.

<CodeGroup>
```ts
// app/apiKey.ts
export const apiKey = "you@example.com"; // or your API key
```
</CodeGroup>

## Define a Schema
Jazz uses Zod for more simple data types (like strings, numbers, booleans), and its own schemas to create collaborative data structures known as CoValues.  CoValues are automatically persisted across your devices and the cloud and synced in real-time. Here we're defining a schema made up of both Zod types and CoValues. 

Adding a `root` to the user's account gives us a container that can be used to keep a track of all the data a user might need to use the app. The migration runs when the user logs in, and ensures the account is properly set up before we try to use it.

<CodeGroup>
```ts
// app/schema.ts
import { co, z } from "jazz-tools";

export const Band = co.map({
  name: z.string(), // Zod primitive type
});

export const JazzFestAccountRoot = co.map({
  myFestival: co.list(Band),
});

export const JazzFestAccount = co
  .account({
    root: JazzFestAccountRoot,
    profile: co.profile(),
  })
  .withMigration((account) => {
    // We need to check specifically for undefined
    // because the root may be null while it's loading
    if (account.root === undefined) {
      account.root = JazzFestAccountRoot.create({
        myFestival: [],
      });
    }
  });
```
</CodeGroup>

## Add the Jazz Provider

Wrap your app with `JazzReactProvider` so components can use Jazz.

<CodeGroup>
```tsx
// app/layout.tsx
"use client";
import { JazzReactProvider } from "jazz-tools/react";
import { apiKey } from "@/app/apiKey";
import { JazzFestAccount } from "@/app/schema";

export default function RootLayout({ 
  children
}: { 
  children: React.ReactNode 
}) {
  return (
    <html lang="en">
      <body>
        <JazzReactProvider
          sync={{ peer: `wss://cloud.jazz.tools/?key=${apiKey}` }}
          AccountSchema={JazzFestAccount}
        >
          {children}
        </JazzReactProvider>
      </body>
    </html>
  );
}
```
</CodeGroup>

<Alert variant="info" className="mt-4 flex gap-2 items-center">
  `"use client";` tells Next.js that this component can't be server-side rendered. If you're not using Next.js, you can remove it.
</Alert>

## Start your app
Moment of truth&thinsp;â€”&thinsp;time to start your app and see if it works.

<CodeGroup>
```sh
pnpm run dev
```
</CodeGroup>

If everything's going according to plan, you should see a login prompt! 

### No log in prompt? 
- Check you wrapped your app with the Jazz Provider in `app/layout.tsx`
- Check your schema is properly defined in `app/schema.ts`
- Ask for help on [Discord](https://discord.gg/utDMjHYg42).

## Create data
Let's create a simple form to add a new band to the festival. We'll use the `useAccount` hook to get the current account and tell Jazz to load the `myFestival` CoValue by passing a `resolve` query.

<CodeGroup className="mt-4 [&_span]:[tab-size:2]" preferWrap>
```tsx
// app/components/NewBand.tsx
"use client";
import { useAccount } from "jazz-tools/react";
import { useState } from "react";
import { Band, JazzFestAccount } from "@/app/schema";

export function NewBand() {
  const { me } = useAccount(JazzFestAccount, { resolve: { root: { myFestival: true } } });
  const [name, setName] = useState("");

  const handleSave = () => {
    if (!me) return; // not loaded yet
    me.root.myFestival.push(Band.create({ name }));
    setName("");
  };

  return (
    <div>
      <input
        type="text"
        value={name}
        placeholder="Band name"
        onChange={(e) => setName(e.target.value)}
      />
      <button type="button" onClick={handleSave}>Add</button>
    </div>
  );
}
```
</CodeGroup>

## Display your data
Now we've got a way to create data, so let's add a component to display it.

<CodeGroup className="mt-4 [&_span]:[tab-size:2]">
```tsx
// app/components/MyFestival.tsx
"use client";
import { useAccount } from "jazz-tools/react";
import { JazzFestAccount } from "@/app/schema";

export function MyFestival() {
  const { me } = useAccount(JazzFestAccount, { resolve: { root: { myFestival: true } } });
  if (!me) return null; // not loaded yet
  return (
    <ul>
      {me?.root.myFestival.map((band) => band && <li key={band.$jazz.id}>{band.name}</li>)}
    </ul>
  );
}
```
</CodeGroup>

## Put it together
You've built all your components, time to put them together.
<CodeGroup className="mt-4 [&_span]:[tab-size:2]">
```tsx
// app/page.tsx
import { NewBand } from "@/app/components/NewBand";
import { MyFestival } from "@/app/components/MyFestival";

export default function Home() {
  return (
    <main>
      <h1>ðŸŽ¶ My Bands</h1>
      <NewBand />
      <MyFestival />
    </main>
  );
}
```
</CodeGroup>

You should now be able to add a band to your festival, and see it in the list! 

## Next steps
- Learn more about [CoValues](/docs/react/schemas/covalues)
- Learn how to edit data with [drafts](/docs/react/design-patterns/drafts)
- Learn how to share and [collaborate on data](/docs/react/groups/intro)